<mvc:View
  controllerName="customdgfiori.controller.Pages.Weather"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:core="sap.ui.core"
  xmlns="sap.m"
  displayBlock="true"
>
  <VBox class="sapUiMediumMargin sapUiResponsiveContentPadding" alignItems="Center">
    <!-- City Selection ComboBox -->
    <HBox class="sapUiSmallMarginBottom" alignItems="Center">
      <Label text="Select City:" labelFor="IDComboCitySelect" />
      <ComboBox
        id="IDComboCitySelect"
        items="{/cities}"
        selectionChange=".onCityChange"
        placeholder="Choose a city"
        width="220px"
        editable="true"
      >
        <core:Item key="{lat},{lon}" text="{name}" />
      </ComboBox>
    </HBox>

    <!-- Weather Data Table -->
    <Table
      id="IDTableCurrentWeather"
      items="{weatherModel>/Forecast}"
      inset="false"
      growing="true"
      growingScrollToLoad="true"
      width="100%"
      class="sapUiResponsiveTable"
    >
      <headerToolbar>
        <Toolbar>
          <Title text="ðŸ“¡ Weather Forecast" level="H2" />
        </Toolbar>
      </headerToolbar>

      <columns>
        <Column><Text text="ðŸ“… Date Time" /></Column>
        <Column><Text text="ðŸŒ¡ Temperature (Â°C)" /></Column>
        <Column><Text text="ðŸ¤’ Feels Like (Â°C)" /></Column>
        <Column><Text text="ðŸŒ¤ Condition" /></Column>
        <Column><Text text="ðŸ’§ Humidity (%)" /></Column>
        <Column><Text text="ðŸŒ¬ Wind (m/s)" /></Column>
      </columns>

      <items>
        <ColumnListItem type="Active">
          <cells>
            <Text text="{weatherModel>dt_txt}" class="sapMTextStrong" />
            <ObjectNumber number="{path: 'weatherModel>temp', formatter: '.formatter.formatKelvinToCelsius'}" unit="Â°C" state="Success" />
            <ObjectNumber number="{path: 'weatherModel>feels_like', formatter: '.formatter.formatKelvinToCelsius'}" unit="Â°C" state="Warning" />
            <Text text="{weatherModel>weather_desc}" />
            <Text text="{weatherModel>humidity}" />
            <Text text="{weatherModel>wind_speed}" />
          </cells>
        </ColumnListItem>
      </items>
    </Table>

    <!-- Custom Weather Icon and Description below the table -->
    <VBox class="sapUiSmallMarginTop" alignItems="Center">
      <Image
        id="weatherIcon"
        width="80px"
        height="80px"
        src="{= 'https://openweathermap.org/img/wn/' + ${weatherModel>/Forecast/0/weather_icon} + '@2x.png'}"
        alt="Current Weather Icon"
      />
      <Text
        text="{weatherModel>/Forecast/0/weather_desc}"
        class="sapMTextCenter"
        wrapping="false"
      />
    </VBox>
  </VBox>
</mvc:View>
